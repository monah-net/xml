<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<page xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="dashboardsConfig.xsd"
      id="xmlMigrationMain">
    <context>
        <variable key="project_XmlMgr" value="XMLToDataSource"/>
        <variable key="branch_XmlMgr" value="xml_decompile_kop"/>
    </context>
    <include name="header_section"/>
    <include name="footer_section"/>
    <separate_instance_selector id="xml_migration_slctr" width="60%">
        <data_source source="xml_migration_process_init" type="DataSource" project="${project_XmlMgr}"
                     branch="${branch_XmlMgr}"/>
    </separate_instance_selector>
    <h_section>
        <button id="init_button" icon_alignment="RIGHT" width="180px" style="primary-button"
                text="Initialize new Instance">
            <open_popup_window height="70%" width="70%" closePath="close_pop_up" popup_title="Initialize new Instance">
                <v_section width="100%">
                    <h_section align="TOP_LEFT">
                        <v_section width="100%">
                            <h_section align="MIDDLE_LEFT">
                                <v_section width="25%">
                                    <label style="heading-2">
                                        <string_value value="As Of Date : "/>
                                        <composite_visibility_condition/>
                                    </label>
                                </v_section>
                                <v_section width="50%" style="indented">
                                    <date_picker id="date_picker_asOfDate" unit="DAY" style="flat" width="50%"
                                                 label_position="TOP">
                                        <default_value>
                                            <date_value value="2020-01-01T00:00:00"/>
                                        </default_value>
                                        <composite_enable_condition/>
                                    </date_picker>
                                </v_section>
                            </h_section>
                            <h_section>
                                <v_section width="25%">
                                    <spacer height="65px"/>
                                    <label icon_alignment="LEFT" style="heading-2">
                                        <string_value value="Input instance keys : "/>
                                        <style type="CAPTION"/>
                                        <composite_visibility_condition/>
                                    </label>
                                </v_section>
                                <v_section width="50%">
                                    <text_field id="filing_ID_var" caption="Filing Type*" input_type="string"
                                                default_value=""
                                                style="sidebar" width="100%" label_position="TOP">
                                        <composite_enable_condition/>
                                    </text_field>
                                    <text_field id="snd_country_var" caption="Sender country*" default_value=""
                                                input_type="string" label_position="TOP" style="sidebar" width="100%">
                                        <composite_enable_condition/>
                                    </text_field>
                                    <text_field id="rec_country_var" caption="Receiver country*" input_type="string"
                                                label_position="TOP" style="sidebar" width="100%">
                                        <composite_enable_condition/>
                                    </text_field>
                                </v_section>
                            </h_section>
                        </v_section>
                    </h_section>
                    <h_section>
                        <spacer height="10px"/>
                        <label style="CAPTION" icon_alignment="LEFT">
                            <string_value value="Variable values : "/>
                            <style type="CAPTION"/>
                            <composite_visibility_condition/>
                        </label>
                    </h_section>
                    <h_section>
                        <v_section>
                            <spacer height="10px"/>
                            <label icon_alignment="LEFT" style="wrap" width="300px">
                                <string_value value="Account Info Type*"/>
                                <composite_visibility_condition/>
                            </label>
                        </v_section>
                        <v_section>
                            <radio_selector id="acct_info_type_var" orientation="HORIZONTAL">
                                <static_radio_selector>
                                    <item caption="AGGREGATED" default="true">
                                        <string_value value="Aggregated"/>
                                    </item>
                                    <item caption="DETAILED" default="false">
                                        <string_value value="Detailed"/>
                                    </item>
                                </static_radio_selector>
                            </radio_selector>
                        </v_section>
                    </h_section>
                    <h_section>
                        <v_section>
                            <spacer height="10px"/>
                            <label icon_alignment="LEFT" style="wrap" width="300px">
                                <string_value value="FATCA (F)/CRS (C)*"/>
                                <composite_visibility_condition/>
                            </label>
                        </v_section>
                        <v_section>
                            <radio_selector id="FatcaCrs_selectr_var" orientation="HORIZONTAL">
                                <static_radio_selector>
                                    <item caption="FATCA" default="true">
                                        <string_value value="F"/>
                                    </item>
                                    <item caption="CRS" default="false">
                                        <string_value value="C"/>
                                    </item>
                                </static_radio_selector>
                            </radio_selector>
                        </v_section>
                    </h_section>
                    <h_section>
                        <v_section>
                            <spacer height="10px"/>
                            <label icon_alignment="LEFT" style="wrap" width="300px">
                                <string_value value="File name for ID Restoring Request*"/>
                                <composite_visibility_condition/>
                            </label>
                        </v_section>
                        <v_section>
                            <text_field id="ris_file_name_var" width="200px" style="card" default_value=""
                                        input_type="string">
                                <composite_enable_condition/>
                            </text_field>
                        </v_section>
                    </h_section>
                    <h_section>
                        <v_section>
                            <spacer height="10px"/>
                            <label icon_alignment="LEFT" style="wrap" width="300px">
                                <string_value value="Full path of the main directory"/>
                                <composite_visibility_condition/>
                            </label>
                        </v_section>
                        <v_section>
                            <text_field id="FatcaMainDirectory_var" width="200px" style="card" default_value=""
                                        input_type="string">
                                <composite_enable_condition/>
                            </text_field>
                        </v_section>
                    </h_section>
                    <h_section>
                        <v_section>
                            <spacer height="10px"/>
                            <label icon_alignment="LEFT" style="wrap" width="300px">
                                <string_value value="Empty Excel Template File Path with File Name*"/>
                                <composite_visibility_condition/>
                            </label>
                        </v_section>
                        <v_section>
                            <text_field id="emptyTemplatePath_var" width="200px" style="card">
                                <composite_enable_condition/>
                            </text_field>
                        </v_section>
                    </h_section>
                    <h_section>
                        <v_section>
                            <spacer height="10px"/>
                            <label icon_alignment="LEFT" style="wrap" width="300px">
                                <string_value value="Generate Template For Refiling (YES/NO)"/>
                                <composite_visibility_condition/>
                            </label>
                        </v_section>
                        <v_section>
                            <radio_selector id="gener_template" orientation="HORIZONTAL">
                                <static_radio_selector>
                                    <item caption="YES" default="true">
                                        <string_value value="YES"/>
                                    </item>
                                    <item caption="NO" default="false">
                                        <string_value value="NO"/>
                                    </item>
                                </static_radio_selector>
                            </radio_selector>
                        </v_section>
                    </h_section>
                    <h_section>
                        <v_section>
                            <spacer height="10px"/>
                            <label icon_alignment="LEFT" style="wrap" width="300px">
                                <string_value value="Path for Generated Template with Data for Refiling"/>
                                <composite_visibility_condition/>
                            </label>
                        </v_section>
                        <v_section>
                            <text_field id="outputTemplateDir" width="200px" style="card">
                                <composite_enable_condition/>
                            </text_field>
                        </v_section>
                    </h_section>
                    <h_section>
                        <v_section>
                            <spacer height="10px"/>
                            <label icon_alignment="LEFT" style="wrap" width="300px">
                                <string_value value="Submission File Name"/>
                                <composite_visibility_condition/>
                            </label>
                        </v_section>
                        <v_section>
                            <text_field id="SUBMISSION_FILE_NAME_var" width="200px" style="card">
                                <composite_enable_condition/>
                            </text_field>
                        </v_section>
                    </h_section>
                    <h_section>
                        <v_section>
                            <spacer height="10px"/>
                            <label icon_alignment="LEFT" style="wrap" width="300px">
                                <string_value value="FATCA Payload Directory"/>
                                <composite_visibility_condition/>
                            </label>
                        </v_section>
                        <v_section>
                            <text_field id="FATCAPayLoadDirectory_var" width="200px" style="card">
                                <composite_enable_condition/>
                            </text_field>
                        </v_section>
                    </h_section>
                    <h_section>
                        <v_section>
                            <spacer height="10px"/>
                            <label icon_alignment="LEFT" style="wrap" width="300px">
                                <string_value value="File name path*"/>
                                <composite_visibility_condition/>
                            </label>
                        </v_section>
                        <v_section>
                            <text_field id="FileNamePath_var" width="200px" style="card">
                                <composite_enable_condition/>
                            </text_field>
                        </v_section>
                    </h_section>
                    <h_section>
                        <v_section>
                            <spacer height="10px"/>
                            <label icon_alignment="LEFT" style="wrap" width="300px">
                                <string_value value="Metadata File Name"/>
                                <composite_visibility_condition/>
                            </label>
                        </v_section>
                        <v_section>
                            <text_field id="MetaDataFileName_var" width="200px" style="card">
                                <composite_enable_condition/>
                            </text_field>
                        </v_section>
                    </h_section>
                    <spacer height="10px"/>
                    <h_section align="STRETCH_LEFT">
                        <label>
                            <string_value value="* - mandatory fields for the filling"/>
                            <composite_visibility_condition/>
                        </label>
                    </h_section>
                    <spacer height="30px"/>
                    <h_section align="MIDDLE_LEFT">
                        <label width="35%" >
                            <model_value reference="wf_status"/>
                            <composite_visibility_condition/>
                        </label>
                        <button text="Submit" style="primary-button" width="200px" icon_alignment="LEFT">
                            <action_chain>
                                <run_workflow restart_all_modules="true" status_path="wf_status">
                                    <workflow>
                                        <project>
                                            <string_value value="${project_XmlMgr}"/>
                                        </project>
                                        <branch>
                                            <string_value value="${branch_XmlMgr}"/>
                                        </branch>
                                        <name>
                                            <string_value value="XML_MIGRATION_PROCESS_INIT"/>
                                        </name>
                                    </workflow>
                                    <instance>
                                        <instance_provider>
                                            <as_of_date>
                                                <model_value reference="date_picker_asOfDate" mode="value"/>
                                            </as_of_date>
                                            <keys>
                                                <variable name="filing_id">
                                                    <model_value reference="filing_ID_var" mode="value"/>
                                                </variable>
                                                <variable name="snd_country">
                                                    <model_value reference="snd_country_var" mode="value"/>
                                                </variable>
                                                <variable name="rec_country">
                                                    <model_value reference="rec_country_var" mode="value"/>
                                                </variable>
                                            </keys>
                                        </instance_provider>
                                    </instance>
                                    <variables>
                                        <variable name="acct_info_type_WFvar">
                                            <model_value reference="acct_info_type_var" mode="value"/>
                                        </variable>
                                        <variable name="FATCA_CRS_WFvar">
                                            <model_value reference="FatcaCrs_selectr_var" mode="value"/>
                                        </variable>
                                        <variable name="ris_file_name_WFvar">
                                            <model_value reference="ris_file_name_var" mode="value"/>
                                        </variable>
                                        <variable name="FatcaMainDirectory_WFvar">
                                            <model_value reference="ris_file_name_var" mode="value"/>
                                        </variable>
                                        <variable name="emptyTemplatePath_WFvar">
                                            <model_value reference="emptyTemplatePath_var" mode="value"/>
                                        </variable>
                                        <variable name="gener_template_WFvar">
                                            <model_value reference="gener_template" mode="value"/>
                                        </variable>
                                        <variable name="outputTemplateDir_WFvar">
                                            <model_value reference="outputTemplateDir" mode="value"/>
                                        </variable>
                                        <variable name="SUBMISSION_FILE_NAME_WFvar">
                                            <model_value reference="SUBMISSION_FILE_NAME_var" mode="value"/>
                                        </variable>
                                        <variable name="FATCAPayLoadDirectory_WFvar">
                                            <model_value reference="FATCAPayLoadDirectory_var" mode="value"/>
                                        </variable>
                                    </variables>
<!--                                    <positive_result_action>-->
<!--                                        <refresh_component component_id="Customer_Details"/>-->
<!--                                    </positive_result_action>-->
                                    <negative_result_action>
                                        <open_popup_window height="500px" width="300px">
                                            <label>
                                                <string_value
                                                        value="Instance initialisation was failed, please check all input parameters"/>
                                                <composite_visibility_condition/>
                                            </label>
                                        </open_popup_window>
                                    </negative_result_action>
                                </run_workflow>
<!--                                <data_source_update>-->
<!--                                    <source_address project="${project}" branch="${branch}"-->
<!--                                                    name="xml_init_history_source"/>-->
<!--                                    <fields>-->
<!--                                        <field name="action_name">-->
<!--                                            <string_value value="Instance initialisation"/>-->
<!--                                        </field>-->
<!--                                        <field name="comment_val">-->
<!--                                            <model_value reference="comment_notif"/>-->
<!--                                        </field>-->
<!--                                        <field name="user_name">-->
<!--                                            <function_value function="=userName()"/>-->
<!--                                        </field>-->
<!--                                        <field name="user_ID">-->
<!--                                            <function_value function="=userId()"/>-->
<!--                                        </field>-->
<!--                                    </fields>-->
<!--                                    <keys>-->
<!--                                        <field name="customer_ID">-->
<!--                                            <model_value reference="Customer_Details"/>-->
<!--                                        </field>-->
<!--                                        <field name="timeStampValue">-->
<!--                                            <function_value function="=currentDateInMillis()"/>-->
<!--                                        </field>-->
<!--                                    </keys>-->
<!--                                </data_source_update>-->
                                <set_model_property property_path="close_popup" global="true">
                                    <value>
                                        <function_value function="=uuid()"/>
                                    </value>
                                </set_model_property>
<!--                                <refresh_component component_id="Customer_Details"/>-->
                            </action_chain>
                            <composite_enable_condition>
                                <enable_condition>
                                    <model_value reference="ris_file_name_var"/>
                                    <is_not_empty/>
                                </enable_condition>
                                <enable_condition>
                                    <model_value reference="emptyTemplatePath_var"/>
                                    <is_not_empty/>
                                </enable_condition>
                                <enable_condition>
                                    <model_value reference="FileNamePath_var"/>
                                    <is_not_empty/>
                                </enable_condition>
                                <enable_condition>
                                    <model_value reference="filing_ID_var"/>
                                    <is_not_empty/>
                                </enable_condition>
                                <enable_condition>
                                    <model_value reference="snd_country_var"/>
                                    <is_not_empty/>
                                </enable_condition>
                                <enable_condition>
                                    <model_value reference="rec_country_var"/>
                                    <is_not_empty/>
                                </enable_condition>
                            </composite_enable_condition>
                            <composite_visibility_condition/>
                        </button>
                        <spacer width="50px"/>
                        <button text="Cancel" style="secondary-button" width="200px">
                            <set_model_property property_path="close_pop_up" global="false">
                                <value>
                                    <function_value function="=uuid()"/>
                                </value>
                            </set_model_property>
                            <composite_enable_condition/>
                            <composite_visibility_condition/>
                        </button>
                    </h_section>
                </v_section>
            </open_popup_window>
            <composite_enable_condition/>
            <composite_visibility_condition/>
        </button>
    </h_section>
</page>