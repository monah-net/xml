<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<page xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="dashboardsConfig.xsd"
      id="xmlMigrationMainTab">
    <include name="header_section"/>
    <include name="footer_section"/>
    <h_section>
        <upload_button id="xmlMigration">
            <file_folder>
                <string_value value="FCRS_RPT_DIR"/>
            </file_folder>
        </upload_button>
        <button id="init_button" icon_alignment="RIGHT" width="180px" style="outline{purple}**"
                text="Initialize new Instance">
            <open_popup_window height="50%" width="50%" closePath="close_pop_up" popup_title="Initialize new Instance">
                <v_section>
                    <h_section>
                        <radio_selector id="radioID">
                            <static_radio_selector>
                                <item default="true" caption="FATCA">
                                    <string_value value="FATCA"/>
                                </item>
                                <item default="false" caption="CRS">
                                    <string_value value="CRS"/>
                                </item>
                            </static_radio_selector>
                        </radio_selector>
                    </h_section>
                    <h_section style="" align="MIDDLE_CENTER">
                        <v_section width="15%">
                            <spacer height="20px"/>
                            <label icon_alignment="LEFT" tooltip="Please insert instance keys for your execution">
                                <string_value value="Input instance keys : "/>
                                <style type="CAPTION"/>
                            </label>
                        </v_section>
                        <v_section width="25%">
                            <text_field id="filing_ID_var" caption="Filing Type" input_type="string" default_value="" style="sidebar" width="100%" label_position="TOP">
                                <composite_enable_condition/>
                            </text_field>
                        </v_section>
                        <v_section width="25%">
                            <text_field id="snd_country_var" caption="Sender country" default_value=""
                                        input_type="string" label_position="TOP" style="sidebar" width="100%">
                                <composite_enable_condition/>
                            </text_field>
                        </v_section>
                        <v_section width="25%">
                            <text_field id="rec_country_var" caption="Receiver country" input_type="string"
                                        label_position="TOP" style="sidebar" width="100%">
                                <composite_enable_condition/>
                            </text_field>
                        </v_section>
                    </h_section>
                    <h_section>
                        <label style="CAPTION">
                            <string_value value="Variable values : "/>
                        </label>
                    </h_section>
                    <h_section>
                        <text_field id="acct_info_type_var" caption="Account Info Type">
                            <composite_enable_condition/>
                        </text_field>
                        <text_field id="FATCA_CRS" caption="FATCA (F)/CRS (C)">
                            <composite_enable_condition/>
                        </text_field>
                        <text_field id="ris_file_name_var" caption="File name for ID Restoring Request">
                            <composite_enable_condition/>
                        </text_field>
                        <text_field id="FatcaMainDirectory_var" caption="Full path of the main directory">
                            <composite_enable_condition/>
                        </text_field>
                        <text_field id="emptyTemplatePath_var" caption="Empty Excel Template File Path with File Name">
                            <composite_enable_condition/>
                        </text_field>
                        <text_field id="gener_template_var" caption="Generate Template For Refiling (YES/NO)">
                            <composite_enable_condition/>
                        </text_field>
                        <text_field id="outputTemplateDir_var"
                                    caption="Path for Generated Template with Data for Refiling">
                            <composite_enable_condition/>
                        </text_field>
                        <text_field id="SUBMISSION_FILE_NAME_var"
                                    caption="Path for Generated Template with Data for Refiling">
                            <composite_enable_condition/>
                        </text_field>
                        <text_field id="FATCAPayLoadDirectory_var" caption="FATCA Payload Directory">
                            <composite_enable_condition/>
                        </text_field>
                    </h_section>
                    <h_section>
                        <button text="Submit" style="primary-button" width="200px">
                            <action_chain>
                                <run_workflow>
                                    <workflow>
                                        <project>
                                            <string_value value="${project}"/>
                                        </project>
                                        <branch>
                                            <string_value value="${branch}"/>
                                        </branch>
                                        <name>
                                            <string_value value="SendNotificationButton"/>
                                        </name>
                                    </workflow>
                                    <instance>
                                        <instance_selector_ref reference="cic_instance_selector"/>
                                    </instance>
                                    <variables>
                                        <variable name="customers">
                                            <multiselection_value reference="Customer_Details" as_string="true"/>
                                        </variable>
                                        <variable name="rm_name">
                                            <model_value reference="rmlist_notification" global="true" mode="value"/>
                                        </variable>
                                        <variable name="notif_comment">
                                            <model_value reference="comment_notif" mode="value" global="false"/>
                                        </variable>
                                        <variable name="notif_type">
                                            <model_value reference="notification_type_list" mode="value"
                                                         global="false"/>
                                        </variable>
                                        <variable name="notif_template">
                                            <model_value reference="customer_notification_template" global="false"
                                                         mode="value"/>
                                        </variable>
                                    </variables>
                                    <positive_result_action>
                                        <refresh_component component_id="Customer_Details"/>
                                    </positive_result_action>
                                    <negative_result_action>
                                        <open_popup_window height="50px" width="100px">
                                            <label>
                                                <string_value
                                                        value="Sending notifications were failed, please see log of SendNotificationButton workflow"/>
                                                <composite_visibility_condition/>
                                            </label>
                                        </open_popup_window>
                                    </negative_result_action>
                                </run_workflow>
                                <data_source_update>
                                    <source_address project="${project}" branch="${branch}" name="cic_history_source"/>
                                    <fields>
                                        <field name="action_name">
                                            <string_value value="Sending notification"/>
                                        </field>
                                        <field name="comment_val">
                                            <model_value reference="comment_notif"/>
                                        </field>
                                        <field name="user_name">
                                            <function_value function="=userName()"/>
                                        </field>
                                        <field name="user_ID">
                                            <function_value function="=userId()"/>
                                        </field>
                                    </fields>
                                    <keys>
                                        <field name="customer_ID">
                                            <model_value reference="Customer_Details"/>
                                        </field>
                                        <field name="timeStampValue">
                                            <function_value function="=currentDateInMillis()"/>
                                        </field>
                                    </keys>
                                </data_source_update>
                                <set_model_property property_path="close_popup" global="true">
                                    <value>
                                        <function_value function="=uuid()"/>
                                    </value>
                                </set_model_property>
                                <refresh_component component_id="Customer_Details"/>
                            </action_chain>
                            <composite_enable_condition/>
                            <composite_visibility_condition/>
                        </button>
                        <button text="Cancel" style="secondary-button" width="200px">
                            <set_model_property property_path="close_pop_up" global="false">
                                <value>
                                    <function_value function="=uuid()"/>
                                </value>
                            </set_model_property>
                            <composite_enable_condition/>
                            <composite_visibility_condition/>
                        </button>
                    </h_section>
                </v_section>
            </open_popup_window>
        </button>
    </h_section>
</page>